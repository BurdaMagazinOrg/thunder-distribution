/*! For license information please see elastic-apm-js-base.umd.min.js.LICENSE */
!function(n){var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=11)}([function(t,e,n){var r=n(1),i=[].slice,a=n(6),o=n(18);function s(){return"withCredentials"in new window.XMLHttpRequest}for(var c=[],u=0;u<256;++u)c[u]=(u+256).toString(16).substr(1);function f(t,e){var n=e||0,r=c;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}function d(t,e,n,r){return"number"==typeof t&&(t=String(t)),n&&!t&&(t=r||"NA"),t?String(t).substr(0,e):t}var h=["fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];function l(t){return null!==t&&"object"==typeof t}function p(t){return"function"==typeof t}function v(t,e,n){for(var r=0,i=e.length;r<i;++r){var o=e[r];if(l(o)||p(o))for(var a=Object.keys(o),s=0,c=a.length;s<c;s++){var u=a[s],f=o[u];n&&l(f)?(l(t[u])||(t[u]=Array.isArray(f)?[]:{}),v(t[u],[f],!1)):t[u]=f}}return t}function g(){if("undefined"!=typeof document)for(var t=document.getElementsByTagName("script"),e=0,n=t.length;e<n;e++){var r=t[e];if(0<r.src.indexOf("elastic"))return r}}function m(t){return t.replace(/[.*"]/g,"_")}t.exports={extend:function(t){return v(t,i.call(arguments,1),!1)},merge:function(t){return v(t,i.call(arguments,1),!0)},isUndefined:function(t){return void 0===t},noop:function(){},baseExtend:v,bytesToHex:f,isCORSSupported:s,isObject:l,isFunction:p,isPlatformSupported:function(){return"undefined"!=typeof window&&"function"==typeof Array.prototype.forEach&&"function"==typeof JSON.stringify&&"function"==typeof Function.bind&&window.performance&&"function"==typeof window.performance.now&&s()},isDtHeaderValid:function(t){return/^[\da-f]{2}-[\da-f]{32}-[\da-f]{16}-[\da-f]{2}$/.test(t)&&"00000000000000000000000000000000"!==t.slice(3,35)&&"0000000000000000"!==t.slice(36,52)},parseDtHeaderValue:function(t){var e=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})$/.exec(t);if(e){var n="00"!==e[4];return{traceId:e[2],id:e[3],sampled:n}}},getNavigationTimingMarks:function(){var n=window.performance.timing,r=n.fetchStart,i={};return h.forEach(function(t){var e=n[t];e&&r<=e&&(i[t]=e-r)}),i},getPaintTimingMarks:function(){var t={},e=window.performance;if(e.getEntriesByType){var n=e.getEntriesByType("paint");if(0<n.length)for(var r=e.timing,i=r.fetchStart-r.navigationStart,o=0;o<n.length;o++){var a=n[o],s=0<=i?a.startTime-i:a.startTime;t[a.name]=s}}return t},getDtHeaderValue:function(t){if(t&&t.traceId&&t.id&&t.parentId){var e=t.sampled?"01":"00",n=t.sampled?t.id:t.parentId;return"00-"+t.traceId+"-"+n+"-"+e}},getPageMetadata:function(){return{page:{referer:document.referrer,url:window.location.href}}},getCurrentScript:function(){if("undefined"!=typeof document){var t=document.currentScript;return t||g()}},getElasticScript:g,getTimeOrigin:function(){return window.performance.timing.fetchStart},generateRandomId:function(t){return f(o()).substr(0,t)},rng:o,checkSameOrigin:function e(n,t){var r=!1;if("string"==typeof t){var i=new a(n),o=new a(t);r=i.origin===o.origin}else Array.isArray(t)&&t.forEach(function(t){r||(r=e(n,t))});return r},sanitizeString:d,sanitizeObjectStrings:function n(r,i,o,a){return r?"string"==typeof r?d(r,i,o,a):(Object.keys(r).forEach(function(t){var e=r[t];"string"==typeof e?e=d(r[t],i,o,a):"object"==typeof e&&(e=n(e,i,o,a)),r[t]=e}),r):r},setTag:function(t,e,n){if(n&&t)return n[m(t)]=d(e,r.serverStringLimit),n},stripQueryStringFromUrl:function(t){return t&&t.split("?")[0]},find:function(t,e,n){if(null==t)throw new TypeError("array is null or not defined");var r=Object(t),i=r.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var o=0;o<i;){var a=r[o];if(e.call(n,a,o,r))return a;o++}},removeInvalidChars:m}},function(t,e){t.exports={SCHEDULE:"schedule",INVOKE:"invoke",CLEAR:"clear",FETCH_SOURCE:"fetch",XMLHTTPREQUEST_SOURCE:"XMLHttpRequest.send",ADD_EVENT_LISTENER_STR:"addEventListener",REMOVE_EVENT_LISTENER_STR:"removeEventListener",serverStringLimit:1024}},function(t,e){function d(t){return"__apm_symbol__"+t}t.exports={apmSymbol:d,patchMethod:function(t,e,n){for(var r=t;r&&!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);!r&&t[e]&&(r=t);var i,o,a,s,c=d(e);if(r&&!(i=r[c])){i=r[c]=r[e];var u=r&&Object.getOwnPropertyDescriptor(r,e);if(!(s=u)||!1!==s.writable&&("function"!=typeof s.get||void 0!==s.set)){var f=n(i,c,e);r[e]=function(){return f(this,arguments)},o=r[e],a=i,o[d("OriginalDelegate")]=a}}return i},globalState:{fetchInProgress:!1},XHR_IGNORE:d("xhrIgnore"),XHR_SYNC:d("xhrSync"),XHR_URL:d("xhrURL"),XHR_METHOD:d("xhrMethod")}},function(t,e){var n=function(){function t(){this.subscriptions=[]}var e=t.prototype;return e.subscribe=function(e){var n=this;return this.subscriptions.push(e),function(){var t=n.subscriptions.indexOf(e);-1<t&&n.subscriptions.splice(t,1)}},e.applyAll=function(e,n){this.subscriptions.forEach(function(t){try{t.apply(e,n)}catch(t){console.log(t,t.stack)}},this)},t}();t.exports=n},,function(t,e,n){var r=n(13),i=n(19),o=n(25),a=n(0),s=n(7);t.exports={createServiceFactory:function(){var t=new o;return t.registerCoreServices(),r.registerServices(t),i.registerServices(t),t},ServiceFactory:o,patching:s,utils:a}},function(t,e){var l=[["#","hash"],["?","query"],["/","path"],[NaN,"host",1]],n=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,r=function(){function t(t){var e,n=this.extractProtocol(t||""),r=n.protocol,i=n.address,o=n.slashes,a=!r&&!o,s=this.getLocation(),c=l.slice();i=i.replace("\\","/");for(var u=0;u<c.length;u++){var f=c[u],d=f[0],h=f[1];"string"==typeof d?~(e=i.indexOf(d))&&(this[h]=i.slice(e),i=i.slice(0,e)):this[h]=i,this[h]=this[h]||a&&f[2]&&s[h]||"",f[2]&&(this[h]=this[h].toLowerCase())}this.protocol=r||s.protocol||"",this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null"}var e=t.prototype;return e.getLocation=function(){var t={};return"undefined"!=typeof window&&(t=window),t.location},e.extractProtocol=function(t){var e=n.exec(t);return{protocol:e[1]?e[1].toLowerCase():"",slashes:!!e[2],address:e[3]}},t}();t.exports=r},function(t,e,n){var r=n(21).patchXMLHttpRequest,i=n(22).patchFetch,o=new(n(3)),a=!1;t.exports={patchAll:function(){return a||(a=!0,r(function(t,e){o.applyAll(this,[t,e])}),i(function(t,e){o.applyAll(this,[t,e])})),o},subscription:o}},function(t,e,n){var r=function(o){var t,e;function n(t,e,n){var r;if((r=o.call(this,t,e,n)||this).parentId=r.options.parentId,r.subType=void 0,r.action=void 0,-1!==r.type.indexOf(".")){var i=r.type.split(".",3);r.type=i[0],r.subType=i[1],r.action=i[2]}return r.sync=r.options.sync,r}return e=o,(t=n).prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e,n}(n(9));t.exports=r},function(t,e,n){var r=n(0),i=r.isUndefined,o=r.generateRandomId,a=r.setTag,s=r.merge,c=function(){function t(t,e,n){this.options=n||{},this.name=t||this.options.name||"Unknown",this.type=e||this.options.type||"custom",this.id=this.options.id||o(16),this.traceId=this.options.traceId,this.sampled=this.options.sampled,this.timestamp=this.options.timestamp||Date.now(),this.ended=!1,this._start=window.performance.now(),this._end=void 0,this.onEnd=this.options.onEnd}var e=t.prototype;return e.ensureContext=function(){this.context||(this.context={})},e.addTags=function(e){this.ensureContext();var n=this.context;n.tags||(n.tags={}),Object.keys(e).forEach(function(t){a(t,e[t],n.tags)})},e.addContext=function(t){t&&(this.ensureContext(),s(this.context,t))},e.end=function(){this.ended||(this.ended=!0,this._end=window.performance.now(),this.callOnEnd())},e.callOnEnd=function(){"function"==typeof this.onEnd&&this.onEnd(this)},e.duration=function(){if(i(this._end)||i(this._start))return null;var t=this._end-this._start;return parseFloat(t)},t}();t.exports=c},function(t,e,n){var a=n(8),r=n(9),i=n(0),o=i.generateRandomId,s=i.getNavigationTimingMarks,c=i.getPaintTimingMarks,u=i.merge,f=i.extend,d=i.getPageMetadata,h=i.removeInvalidChars,l=function(i){var t,e;function n(t,e,n){var r;return(r=i.call(this,t,e,n)||this).traceId=o(),r.marks=void 0,r.spans=[],r._activeSpans={},r._scheduledTasks={},r.nextAutoTaskId=0,r.isHardNavigation=!1,r.sampled=Math.random()<=r.options.transactionSampleRate,r}e=i,(t=n).prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e;var r=n.prototype;return r.addNavigationTimingMarks=function(){var t=s(),e=c();if(t){var n={timeToFirstByte:t.responseStart,domInteractive:t.domInteractive,domComplete:t.domComplete};e["first-contentful-paint"]&&(n.firstContentfulPaint=e["first-contentful-paint"]),this.addMarks({navigationTiming:t,agent:n})}},r.addMarks=function(t){this.marks=u(this.marks||{},t)},r.mark=function(t){var e=h(t),n=window.performance.now()-this._start,r={};r[e]=n,this.addMarks({custom:r})},r.redefine=function(t,e,n){this.name=t,this.type=e,this.options=n},r.startSpan=function(t,e,n){if(!this.ended){var r=this,i=f({},n);i.onEnd=function(t){r._onSpanEnd(t)},i.traceId=this.traceId,i.sampled=this.sampled,i.parentId||(i.parentId=this.id);var o=new a(t,e,i);return this._activeSpans[o.id]=o}},r.isFinished=function(){return 0===Object.keys(this._scheduledTasks).length},r.detectFinish=function(){this.isFinished()&&this.end()},r.end=function(){if(!this.ended){for(var t in this.ended=!0,this._end=window.performance.now(),this._activeSpans){var e=this._activeSpans[t];e.type=e.type+".truncated",e.end()}var n=d();this.addContext(n),this._adjustStartToEarliestSpan(),this._adjustEndToLatestSpan(),this.callOnEnd()}},r.addTask=function(t){return void 0===t&&(t="autoId"+this.nextAutoTaskId++),this._scheduledTasks[t]=t},r.removeTask=function(t){delete this._scheduledTasks[t],this.detectFinish()},r.addEndedSpans=function(t){this.spans=this.spans.concat(t)},r.resetSpans=function(){this.spans=[]},r._onSpanEnd=function(t){this.spans.push(t),delete this._activeSpans[t.id]},r._adjustEndToLatestSpan=function(){var t=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n];r.type&&-1===r.type.indexOf("ext")&&"transaction"!==r.type&&(!e||e._end<r._end)&&(e=r)}return e}(this.spans);if(t){this._end=t._end;for(var e=0;e<this.spans.length;e++){var n=this.spans[e];n._end>this._end&&(n._end=this._end,n.type=n.type+".truncated"),n._start>this._end&&(n._start=this._end)}}},r._adjustStartToEarliestSpan=function(){var t,e,n=(t=this.spans,e=null,t.forEach(function(t){e||(e=t),e&&e._start>t._start&&(e=t)}),e);n&&n._start<this._start&&(this._start=n._start)},n}(r);t.exports=l},function(t,e,n){var r=n(12)(),i=n(5),o=n(34),a=new o(i.createServiceFactory(),!r);"undefined"!=typeof window&&(window.elasticApm=a);e={__esModule:!0,default:a.init.bind(a),init:a.init.bind(a),ApmBase:o,apmBase:a,apm:a};t.exports=e},function(t,e,n){var r=!1,i=!1;t.exports=function(){if(r)return i;r=!0;var t=n(5);return t.utils.isPlatformSupported()?(n(32),t.patching.patchAll(),i=!0):console.log("APM: Platform is not supported!"),i}},function(t,e,n){var o=n(14);t.exports={ErrorLogging:o,registerServices:function(i){i.registerServiceCreator("ErrorLogging",function(){var t=i.getService("ApmServer"),e=i.getService("ConfigService"),n=i.getService("LoggingService"),r=i.getService("TransactionService");return new o(t,e,n,r)})}}},function(t,e,n){var i=n(15),v=n(0),r=function(){function t(t,e,n,r){this._apmServer=t,this._configService=e,this._loggingService=n,this._transactionService=r,this._stackTraceService=new i(e,n)}var e=t.prototype;return e.createErrorDataModel=function(t){var e,n=this._stackTraceService.cleanFilePath(t.filename),r=this._stackTraceService.filePathToFileName(n),i=this._stackTraceService.createStackTraces(t);if(i=this._stackTraceService.filterInvalidFrames(i),!r&&i.length){var o=i[i.length-1];r=o.filename?o.filename:"(inline script)"}e=this._stackTraceService.isFileInline(n)?"(inline script)":r;var a=t.message||t.error&&t.error.message,s=t.error?t.error.name:void 0;s||(s=a&&-1<a.indexOf(":")?a.split(":")[0]:"");var c,u=this._configService.get("context"),f=this._configService.get("serverStringLimit");t.error&&"object"==typeof t.error&&(c=this._getErrorProperties(t.error));var d=v.getPageMetadata(),h=v.merge({},d,u,c),l={id:v.generateRandomId(),culprit:v.sanitizeString(e),exception:{message:v.sanitizeString(a,void 0,!0),stacktrace:i,type:v.sanitizeString(s,f,!1)},context:h},p=this._transactionService.getCurrentTransaction();return p&&(l.trace_id=p.traceId,l.parent_id=p.id,l.transaction_id=p.id,l.transaction={type:p.type,sampled:p.sampled}),l},e.logErrorEvent=function(t,e){if(this._configService.isActive()){if(void 0===t)return;var n=this.createErrorDataModel(t);if(void 0===n.exception.message)return;return e?this._apmServer.sendErrors([n]):this._apmServer.addError(n)}},e.registerGlobalEventListener=function(){var a=this;window.onerror=function(t,e,n,r,i){var o;o=void 0!==t&&"string"!=typeof t?t:{message:t,filename:e,lineno:n,colno:r,error:i},a.logErrorEvent(o)}},e.logError=function(t){var e={};return"string"==typeof t?e.message=t:e.error=t,this.logErrorEvent(e)},e._getErrorProperties=function(n){var r={};return Object.keys(n).forEach(function(t){if("stack"!==t){var e=n[t];if(null!==e){switch(typeof e){case"function":return;case"object":if("function"!=typeof e.toISOString)return;e=e.toISOString()}r[t]=e}}}),r},t}();t.exports=r},function(t,e,n){var i=n(16),r=function(){function t(t,e){this._configService=t,this._loggingService=e}var e=t.prototype;return e.createStackTraces=function(t){var e,r=this,n=t.error;if(n)try{e=i.parse(n)}catch(t){this._loggingService.debug("Parsing error stack failed!",t)}return e&&0!==e.length||(e=[{fileName:t.filename,lineNumber:t.lineno,columnNumber:t.colno}]),e=(e=e.map(function(t){return t.functionName&&(t.functionName=(e=t.functionName,e=1<(n=(e=(e=(e=1<(n=e.split("/")).length?["Object",n[n.length-1]].join("."):n[0]).replace(/.<$/gi,".<anonymous>")).replace(/^Anonymous function$/,"<anonymous>")).split(".")).length?n[n.length-1]:n[0])),t;var e,n})).map(function(t){if(!t.fileName&&!t.lineNumber)return{};if(!t.columnNumber&&!t.lineNumber)return{};var e=r.cleanFilePath(t.fileName),n=r.filePathToFileName(e);return r.isFileInline(e)&&(n="(inline script)"),{abs_path:t.fileName,filename:n,function:t.functionName||"<anonymous>",lineno:t.lineNumber,colno:t.columnNumber}})},e.filterInvalidFrames=function(t){var e=[];return Array.isArray(t)&&(e=t.filter(function(t){return void 0!==t.filename&&void 0!==t.lineno})),e},e.filePathToFileName=function(t){var e=window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");return-1<t.indexOf(e)&&(t=t.replace(e+"/","")),t},e.cleanFilePath=function(t){return t||(t=""),"<anonymous>"===t&&(t=""),t},e.isFileInline=function(t){return!!t&&0===window.location.href.indexOf(t)},t}();t.exports=r},function(n,r,i){var o,a,s;!function(t,e){"use strict";a=[i(17)],void 0===(s="function"==typeof(o=function(s){var n=/(^|@)\S+\:\d+/,r=/^\s*at .*(\S+\:\d+|\(native\))/m,i=/^(eval@)?(\[native code\])?$/;function o(t,e,n){if("function"==typeof Array.prototype.map)return t.map(e,n);for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=e.call(n,t[i]);return r}function a(t,e,n){if("function"==typeof Array.prototype.filter)return t.filter(e,n);for(var r=[],i=0;i<t.length;i++)e.call(n,t[i])&&r.push(t[i]);return r}return{parse:function(t){if(void 0!==t.stacktrace||void 0!==t["opera#sourceloc"])return this.parseOpera(t);if(t.stack&&t.stack.match(r))return this.parseV8OrIE(t);if(t.stack)return this.parseFFOrSafari(t);throw new Error("Cannot parse given Error object")},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];var e=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(t.replace(/[\(\)]/g,""));return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(t){var e=a(t.stack.split("\n"),function(t){return!!t.match(r)},this);return o(e,function(t){-1<t.indexOf("(eval ")&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var e=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),n=this.extractLocation(e.pop()),r=e.join(" ")||void 0,i=-1<function(t,e){{if("function"==typeof Array.prototype.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}}(["eval","<anonymous>"],n[0])?void 0:n[0];return new s(r,void 0,i,n[1],n[2],t)},this)},parseFFOrSafari:function(t){var e=a(t.stack.split("\n"),function(t){return!t.match(i)},this);return o(e,function(t){if(-1<t.indexOf(" > eval")&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new s(t);var e=t.split("@"),n=this.extractLocation(e.pop()),r=e.join("@")||void 0;return new s(r,void 0,n[0],n[1],n[2],t)},this)},parseOpera:function(t){return!t.stacktrace||-1<t.message.indexOf("\n")&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(t){for(var e=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),r=[],i=2,o=n.length;i<o;i+=2){var a=e.exec(n[i]);a&&r.push(new s(void 0,void 0,a[2],a[1],void 0,n[i]))}return r},parseOpera10:function(t){for(var e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),r=[],i=0,o=n.length;i<o;i+=2){var a=e.exec(n[i]);a&&r.push(new s(a[3]||void 0,void 0,a[2],a[1],void 0,n[i]))}return r},parseOpera11:function(t){var e=a(t.stack.split("\n"),function(t){return!!t.match(n)&&!t.match(/^Error created at/)},this);return o(e,function(t){var e,n=t.split("@"),r=this.extractLocation(n.pop()),i=n.shift()||"",o=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;i.match(/\(([^\)]*)\)/)&&(e=i.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var a=void 0===e||"[arguments not available]"===e?void 0:e.split(",");return new s(o,a,r[0],r[1],r[2],t)},this)}}})?o.apply(r,a):o)||(n.exports=s)}()},function(n,r,t){var i,o,a;!function(t,e){"use strict";o=[],void 0===(a="function"==typeof(i=function(){function e(t){return!isNaN(parseFloat(t))&&isFinite(t)}function t(t,e,n,r,i,o){void 0!==t&&this.setFunctionName(t),void 0!==e&&this.setArgs(e),void 0!==n&&this.setFileName(n),void 0!==r&&this.setLineNumber(r),void 0!==i&&this.setColumnNumber(i),void 0!==o&&this.setSource(o)}return t.prototype={getFunctionName:function(){return this.functionName},setFunctionName:function(t){this.functionName=String(t)},getArgs:function(){return this.args},setArgs:function(t){if("[object Array]"!==Object.prototype.toString.call(t))throw new TypeError("Args must be an Array");this.args=t},getFileName:function(){return this.fileName},setFileName:function(t){this.fileName=String(t)},getLineNumber:function(){return this.lineNumber},setLineNumber:function(t){if(!e(t))throw new TypeError("Line Number must be a Number");this.lineNumber=Number(t)},getColumnNumber:function(){return this.columnNumber},setColumnNumber:function(t){if(!e(t))throw new TypeError("Column Number must be a Number");this.columnNumber=Number(t)},getSource:function(){return this.source},setSource:function(t){this.source=String(t)},toString:function(){return(this.getFunctionName()||"{anonymous}")+"("+(this.getArgs()||[]).join(",")+")"+(this.getFileName()?"@"+this.getFileName():"")+(e(this.getLineNumber())?":"+this.getLineNumber():"")+(e(this.getColumnNumber())?":"+this.getColumnNumber():"")}},t})?i.apply(r,o):i)||(n.exports=a)}()},function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},function(t,e,n){var o=n(20),r=n(23);t.exports={PerformanceMonitoring:o,registerServices:function(i){i.registerServiceCreator("TransactionService",function(){var t=i.getService("ConfigService"),e=i.getService("LoggingService");return new r(e,t)}),i.registerServiceCreator("PerformanceMonitoring",function(){var t=i.getService("ConfigService"),e=i.getService("LoggingService"),n=i.getService("ApmServer"),r=i.getService("TransactionService");return new o(n,t,e,r)})}}},function(t,e,n){var r=n(0),a=r.sanitizeObjectStrings,s=r.sanitizeString,d=r.checkSameOrigin,c=r.isDtHeaderValid,u=r.getDtHeaderValue,f=r.merge,h=r.stripQueryStringFromUrl,i=r.parseDtHeaderValue,o=n(7).subscription,l=n(2).globalState,p=n(1),v=p.SCHEDULE,g=p.INVOKE,m=p.XMLHTTPREQUEST_SOURCE,S=p.FETCH_SOURCE,y=function(){function t(t,e,n,r){this._apmServer=t,this._configService=e,this._logginService=n,this._transactionService=r}var e=t.prototype;return e.init=function(){var n=this;this._transactionService.subscribe(function(t){var e=n.createTransactionPayload(t);e&&n._apmServer.addTransaction(e)});var t=this.getXhrPatchSubFn(this._configService,this._transactionService);this.cancelPatchSub=o.subscribe(t)},e.getXhrPatchSubFn=function(){var c=this._configService,u=this._transactionService,f=this;return function(t,e){if(e.source===m&&!l.fetchInProgress||e.source===S)if(t===v&&e.data){var n=e.data.method+" "+h(e.data.url),r=u.startSpan(n,"external.http");if(r){var i=c.get("distributedTracing"),o=c.get("distributedTracingOrigins"),a=d(e.data.url,window.location.href)||d(e.data.url,o),s=e.data.target;i&&a&&s&&f.injectDtHeader(r,s),r.addContext({http:{method:e.data.method,url:e.data.url}}),r.sync=e.data.sync,e.data.span=r}}else t===g&&e.data&&e.data.span&&(void 0!==e.data.target.status?e.data.span.addContext({http:{status_code:e.data.target.status}}):e.data.response&&e.data.span.addContext({http:{status_code:e.data.response.status}}),e.data.span.end())}},e.injectDtHeader=function(t,e){var n=this._configService,r=n.get("distributedTracingHeaderName"),i=n.get("distributedTracingHeaderValueCallback");"function"!=typeof i&&(i=u);var o=i(t),a=c(o);r&&o&&a&&("function"==typeof e.setRequestHeader?e.setRequestHeader(r,o):e.headers&&"function"==typeof e.headers.append?e.headers.append(r,o):e[r]=o)},e.extractDtHeader=function(t){var e=this._configService.get("distributedTracingHeaderName");if(t)return i(t[e])},e.setTransactionContext=function(t){var e=this._configService.get("context");e&&t.addContext(e)},e.filterTransaction=function(t){var e=this._configService.get("transactionDurationThreshold"),n=t.duration();if(!n||e<n||!t.spans.length)return!1;t.sampled||t.resetSpans();var r=this._configService.get("browserResponsivenessInterval");if(this._configService.get("checkBrowserResponsiveness")&&!t.isHardNavigation){var i=this._configService.get("browserResponsivenessBuffer");if(!this.checkBrowserResponsiveness(t,r,i))return this._logginService.debug("Transaction was discarded! browser was not responsive enough during the transaction."," duration:",n," browserResponsivenessCounter:",t.browserResponsivenessCounter,"interval:",r),!1}return!0},e.prepareTransaction=function(e){if(e.spans.sort(function(t,e){return t._start-e._start}),this._configService.get("groupSimilarSpans")){var t=this._configService.get("similarSpanThreshold");e.spans=this.groupSmallContinuouslySimilarSpans(e,t)}e.spans=e.spans.filter(function(t){return 0<t.duration()&&t._start>=e._start&&t._end>e._start&&t._start<e._end&&t._end<=e._end}),this.setTransactionContext(e)},e.createTransactionDataModel=function(n){var t=this._configService.get("context"),r=this._configService.get("serverStringLimit"),i=n._start,e=n.spans.map(function(t){var e;return t.context&&(e=a(t.context,r)),{id:t.id,transaction_id:n.id,parent_id:t.parentId||n.id,trace_id:n.traceId,name:s(t.name,r,!0),type:s(t.type,r,!0),subType:s(t.subType,r,!0),action:s(t.action,r,!0),sync:t.sync,start:t._start-i,duration:t.duration(),context:e}}),o=f({},t,n.context);return{id:n.id,trace_id:n.traceId,name:s(n.name,r,!1),type:s(n.type,r,!0),duration:n.duration(),spans:e,context:o,marks:n.marks,span_count:{started:e.length},sampled:n.sampled}},e.createTransactionPayload=function(t){if(this.prepareTransaction(t),this.filterTransaction(t))return this.createTransactionDataModel(t)},e.sendTransactions=function(t){var e=t.map(this.createTransactionPayload.bind(this)).filter(function(t){return t});return this._logginService.debug("Sending Transactions to apm server.",t.length),this._apmServer.sendTransactions(e)},e.convertTransactionsToServerModel=function(t){return t.map(this.createTransactionDataModel.bind(this))},e.groupSmallContinuouslySimilarSpans=function(o,a){var s=o.duration(),c=[],u=1;return o.spans.forEach(function(t,e){if(0===c.length)c.push(t);else{var n=c[c.length-1],r=n.type===t.type&&n.subType===t.subType&&n.action===t.action&&n.name===t.name&&t.duration()/s<a&&(t._start-n._end)/s<a,i=o.spans.length===e+1;r&&(u++,n._end=t._end),1<u&&(!r||i)&&(n.name=u+"x "+n.name,u=1),r||c.push(t)}}),c},e.checkBrowserResponsiveness=function(t,e,n){var r=t.browserResponsivenessCounter;if(void 0===e||void 0===r)return!0;var i=t.duration();return Math.floor(i/e)<=r+n},t}();t.exports=y},function(t,e,n){var r=n(2),i=r.apmSymbol,o=r.patchMethod,h=r.XHR_SYNC,l=r.XHR_URL,p=r.XHR_METHOD,v=r.XHR_IGNORE,a=n(1),g=a.SCHEDULE,m=a.INVOKE,S=a.CLEAR,y=a.XMLHTTPREQUEST_SOURCE,_=a.ADD_EVENT_LISTENER_STR,T=a.REMOVE_EVENT_LISTENER_STR,b=i("xhrTask"),w=i("xhrListener"),E=i("xhrScheduled"),C=!1;t.exports={patchXMLHttpRequest:function(a){if(!C){C=!0;var t=XMLHttpRequest.prototype,s=t[_],c=t[T];if(!s){var e=window.XMLHttpRequestEventTarget;if(e){var n=e.prototype;s=n[_],c=n[T]}}var u="readystatechange",r=o(t,"open",function(){return function(t,e){return t[p]=e[0],t[l]=e[1],t[h]=!1===e[2],r.apply(t,e)}}),f=o(t,"send",function(){return function(t,e){var n={source:y,state:"",type:"macroTask",ignore:t[v],data:{target:t,method:t[p],sync:t[h],url:t[l],args:e,aborted:!1}},r=function(t){XMLHttpRequest[E]=!1,t.state=g,t.ignore||a(g,t);var e=t.data,n=e.target,r=n[w];s||(s=n[_],c=n[T]),r&&c.call(n,u,r);var i=n[w]=function(){n.readyState===n.DONE&&!e.aborted&&XMLHttpRequest[E]&&t.state===g&&d(t)};s.call(n,u,i),n[b]||(n[b]=t);var o=f.apply(n,e.args);return XMLHttpRequest[E]=!0,o}(n);return t[h]&&d(n),r}}),i=o(t,"abort",function(){return function(t,e){var n,r=t[b];if(r&&"string"==typeof r.type){if(r.data&&r.data.aborted)return;(n=r).state=S,a(S,n),n.data.aborted=!0}return i.apply(t,e)}})}function d(t){t.state=m,t.ignore||a(m,t)}}}},function(t,e,n){var f=n(2).globalState,r=n(1),d=r.SCHEDULE,i=r.INVOKE,h=r.FETCH_SOURCE,o=!1;t.exports={patchFetch:function(s){if(!o&&(o=!0,window.fetch&&window.Request)){var c=window.fetch;window.fetch=function(t,e){var i,n,o=this,r=arguments;if("string"==typeof t)i=new Request(t,e),n=t;else{if(!t)return c.apply(o,r);n=(i=t).url}var a={source:h,state:"",type:"macroTask",data:{target:i,method:i.method,sync:!1,url:n,args:arguments,aborted:!1}};return new Promise(function(e,n){var t,r;f.fetchInProgress=!0,(t=a).state=d,s(d,t);try{r=c.apply(o,[i])}catch(t){return n(t),a.data.error=t,u(a),void(f.fetchInProgress=!1)}r.then(function(t){e(t),a.data.response=t,u(a)},function(t){n(t),a.data.error=t,u(a)}),f.fetchInProgress=!1})}}function u(t){t.state=i,s(i,t)}}}},function(t,e,n){var o=n(10),s=n(0),r=n(3),i=n(24).captureHardNavigation,a=function(){function t(t,e){void 0===e&&t.debug("TransactionService: config is not provided"),this._config=e,this._logger=t,this.marks={},this.currentTransaction=void 0,this._subscription=new r,this._alreadyCapturedPageLoad=!1}var e=t.prototype;return e.shouldCreateTransaction=function(){return this._config.isActive()},e.getOrCreateCurrentTransaction=function(){if(this.shouldCreateTransaction()){var t=this.getCurrentTransaction();return s.isUndefined(t)||t.ended?this.createZoneTransaction():t}},e.getCurrentTransaction=function(){return this.currentTransaction},e.setCurrentTransaction=function(t){this.currentTransaction=t},e.createTransaction=function(t,e,n){var r=n;if(s.isUndefined(r)&&(r=this._config.config),this.shouldCreateTransaction()){var i=new o(t,e,r);return this.setCurrentTransaction(i),r.checkBrowserResponsiveness&&this.startCounter(i),i}},e.createZoneTransaction=function(){return this.createTransaction("ZoneTransaction","transaction")},e.startCounter=function(e){e.browserResponsivenessCounter=0;var n=this._config.get("browserResponsivenessInterval");void 0!==n?this.runOuter(function(){var t=setInterval(function(){e.ended?window.clearInterval(t):e.browserResponsivenessCounter++},n)}):this._logger.debug("browserResponsivenessInterval is undefined!")},e.sendPageLoadMetrics=function(t){var e=this.startTransaction(t,"page-load");return e.detectFinish(),e},e.capturePageLoadMetrics=function(t){if(this._config.get("capturePageLoad")&&!this._alreadyCapturedPageLoad&&t.isHardNavigation)return t.addMarks(this.marks),i(t),this._alreadyCapturedPageLoad=!0},e.startTransaction=function(t,e,n){var r=this,i=r._config.config,o=s.extend({pageLoadTraceId:i.pageLoadTraceId,pageLoadSampled:i.pageLoadSampled,pageLoadSpanId:i.pageLoadSpanId,pageLoadTransactionName:i.pageLoadTransactionName,transactionSampleRate:i.transactionSampleRate},n);e||(e="custom"),t||(t="Unknown");var a=this.getOrCreateCurrentTransaction();if(a)return"ZoneTransaction"===a.name?a.redefine(t,e,o):(this._logger.debug("Ending old transaction",a),a.end(),a=this.createTransaction(t,e,o)),"page-load"===e&&(a.isHardNavigation=!0,o.pageLoadTraceId&&(a.traceId=o.pageLoadTraceId),void 0!==o.pageLoadSampled&&(a.sampled=o.pageLoadSampled),"Unknown"===a.name&&i.pageLoadTransactionName&&(a.name=i.pageLoadTransactionName)),this._logger.debug("TransactionService.startTransaction",a),a.onEnd=function(){r.applyAsync(function(){(r._logger.debug("TransactionService transaction finished",a),r.shouldIgnoreTransaction(a.name))||("page-load"===e?("Unknown"===a.name&&r._config.get("pageLoadTransactionName")&&(a.name=r._config.get("pageLoadTransactionName")),r.capturePageLoadMetrics(a)&&r.add(a)):r.add(a))})},a},e.applyAsync=function(t,e,n){return this.runOuter(function(){return Promise.resolve().then(function(){return t.apply(e,n)},function(t){console.log(t)})})},e.shouldIgnoreTransaction=function(t){for(var e=this._config.get("ignoreTransactions"),n=0;n<e.length;n++){var r=e[n];if("function"==typeof r.test){if(r.test(t))return!0}else if(r===t)return!0}return!1},e.startSpan=function(t,e,n){var r=this.getOrCreateCurrentTransaction();if(r)return this._logger.debug("TransactionService.startSpan",t,e),r.startSpan(t,e,n)},e.add=function(t){this._config.isActive()&&(this._subscription.applyAll(this,[t]),this._logger.debug("TransactionService.add",t))},e.subscribe=function(t){return this._subscription.subscribe(t)},e.addTask=function(t){var e=this.getOrCreateCurrentTransaction();return e&&(e.addTask(t),this._logger.debug("TransactionService.addTask",t)),t},e.removeTask=function(t){var e=this.getCurrentTransaction();s.isUndefined(e)||e.ended||(e.removeTask(t),this._logger.debug("TransactionService.removeTask",t))},e.detectFinish=function(){var t=this.getCurrentTransaction();s.isUndefined(t)||t.ended||(t.detectFinish(),this._logger.debug("TransactionService.detectFinish"))},e.runOuter=function(t,e,n){return t.apply(e,n)},t}();t.exports=a},function(t,e,n){var p=n(8),v=n(6),s=[["domainLookupStart","domainLookupEnd","Domain lookup"],["connectStart","connectEnd","Making a connection to the server"],["requestStart","responseEnd","Requesting and receiving the document"],["domLoading","domInteractive","Parsing the document, executing sync. scripts"],["domContentLoadedEventStart","domContentLoadedEventEnd",'Fire "DOMContentLoaded" event'],["loadEventStart","loadEventEnd",'Fire "load" event']],g=3e5;function r(t,e){var n=e.duration();return n<g&&0<n&&e._start<=t._end&&e._end<=t._end}function i(t,e){for(var n=[],r=0;r<s.length;r++){var i=t[s[r][0]],o=t[s[r][1]];if(e&&i&&o&&i<o&&e<=i&&o-i<g&&i-e<g&&o-e<g){var a=new p(s[r][2],"hard-navigation.browser-timing");"requestStart"===s[r][0]&&(a.pageResponse=!0),a._start=i-e,a.ended=!0,a._end=o-e,n.push(a)}}return n}function o(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r];if((!i.initiatorType||"xmlhttprequest"!==i.initiatorType)&&i.name)if("css"!==i.initiatorType&&"img"!==i.initiatorType&&"script"!==i.initiatorType&&"link"!==i.initiatorType){for(var o=!1,a=0;a<e.length;a++){var s=i.name.lastIndexOf(e[a]);if(-1<s&&s===i.name.length-e[a].length){o=!0;break}}if(o)continue}else{var c="resource";i.initiatorType&&(c+="."+i.initiatorType);var u=i.startTime,f=i.responseEnd;if("number"==typeof u&&"number"==typeof f&&0<=u&&u<f&&f-u<g&&u<g&&f<g){var d=new v(i.name),h=d.origin+d.path,l=new p(h||i.name,c);l.addContext({http:{url:i.name}}),l._start=u,l.ended=!0,l._end=f,n.push(l)}}}return n}t.exports={captureHardNavigation:function(e){if(e.isHardNavigation&&window.performance&&window.performance.timing){var t=window.performance.timing,n=t.fetchStart;e._start=0,e.type="page-load",i(t,n).forEach(function(t){r(e,t)&&(t.traceId=e.traceId,t.sampled=e.sampled,e.options.pageLoadSpanId&&t.pageResponse&&(t.id=e.options.pageLoadSpanId),e.spans.push(t))}),window.performance.getEntriesByType&&o(window.performance.getEntriesByType("resource"),e.spans.filter(function(t){return"external"===t.type&&"http"===t.subType}).map(function(t){return t.name.split(" ")[1]})).forEach(function(t){r(e,t)&&e.spans.push(t)}),e._adjustStartToEarliestSpan(),e._adjustEndToLatestSpan(),e.addNavigationTimingMarks()}},createNavigationTimingSpans:i,createResourceTimingSpans:o}},function(t,e,n){var r=n(26),i=n(30),o=n(31),a=n(2),s=n(0),c=function(){function t(){this._serviceCreators={},this._serviceInstances={},this.initialized=!1}var e=t.prototype;return e.registerCoreServices=function(){var t=this;this.registerServiceCreator("ConfigService",function(){return new i}),this.registerServiceCreator("LoggingService",function(){return new o}),this.registerServiceCreator("ApmServer",function(){return new r(t.getService("ConfigService"),t.getService("LoggingService"))}),this.registerServiceInstance("PatchUtils",a),this.registerServiceInstance("Utils",s)},e.init=function(){if(!this.initialized){this.initialized=!0;var t=this.getService("ConfigService");t.init();var e=this.getService("LoggingService");n(e,t),t.subscribeToChange(function(){n(e,t)}),this.getService("ApmServer").init()}function n(t,e){!0===e.get("debug")&&"trace"!==e.config.logLevel?t.setLevel("debug",!1):t.setLevel(e.get("logLevel"),!1)}},e.registerServiceCreator=function(t,e){this._serviceCreators[t]=e},e.registerServiceInstance=function(t,e){this._serviceInstances[t]=e},e.getService=function(t){if(!this._serviceInstances[t]){if("function"!=typeof this._serviceCreators[t])throw new Error("Can not get service, No creator for: "+t);this._serviceInstances[t]=this._serviceCreators[t](this)}return this._serviceInstances[t]},t}();t.exports=c},function(t,e,n){var r=n(27),i=n(28),o=n(0),a=n(29),c=n(2).XHR_IGNORE,s=function(){function t(t,e){this._configService=t,this._loggingService=e,this.logMessages={invalidConfig:{message:"Configuration is invalid!",level:"warn"}},this.errorQueue=void 0,this.transactionQueue=void 0,this.throttleAddError=void 0,this.throttleAddTransaction=void 0,this.initialized=!1,this.ndjsonSpan={}}var e=t.prototype;return e.init=function(){this.initialized||(this.initialized=!0,this.initErrorQueue(),this.initTransactionQueue())},e.createServiceObject=function(){var t=this._configService,e=t.get("serverStringLimit");return{name:o.sanitizeString(t.get("serviceName"),e,!0),version:o.sanitizeString(t.get("serviceVersion"),e,!1),agent:{name:t.get("agentName"),version:t.get("agentVersion")},language:{name:"javascript"}}},e._postJson=function(t,e){return this._makeHttpRequest("POST",t,e,{"Content-Type":"application/x-ndjson"})},e._makeHttpRequest=function(e,o,a,s){return new Promise(function(n,r){var i=new window.XMLHttpRequest;if(i[c]=!0,i.open(e,o,!0),i.timeout=1e4,s)for(var t in s)s.hasOwnProperty(t)&&i.setRequestHeader(t,s[t]);i.onreadystatechange=function(){if(4===i.readyState){var t=i.status;if(0===t||399<t&&t<600){var e=new Error(o+" HTTP status: "+t);e.xhr=i,r(e)}else n(i.responseText)}},i.onerror=function(t){r(t)},i.send(a)})},e._createQueue=function(t){var e=this._configService.get("queueLimit"),n=this._configService.get("flushInterval");return new r(t,{queueLimit:e,flushInterval:n})},e.initErrorQueue=function(){var n=this;this.errorQueue&&this.errorQueue.flush(),this.errorQueue=this._createQueue(function(t){var e=n.sendErrors(t);e&&e.then(void 0,function(t){n._loggingService.warn("Failed sending errors!",t)})});var t=n._configService.get("errorThrottleLimit"),e=n._configService.get("errorThrottleInterval");this.throttleAddError=i(this.errorQueue.add.bind(this.errorQueue),function(){n._loggingService.warn("Dropped error due to throttling!")},{limit:t,interval:e})},e.initTransactionQueue=function(){var n=this;this.transactionQueue&&this.transactionQueue.flush(),this.transactionQueue=this._createQueue(function(t){var e=n.sendTransactions(t);e&&e.then(void 0,function(t){n._loggingService.warn("Failed sending transactions!",t)})});var t=n._configService.get("transactionThrottleLimit"),e=n._configService.get("transactionThrottleInterval");this.throttleAddTransaction=i(this.transactionQueue.add.bind(this.transactionQueue),function(){n._loggingService.warn("Dropped transaction due to throttling!")},{limit:t,interval:e})},e.addError=function(t){this._configService.isActive()&&(this.errorQueue||this.initErrorQueue(),this.throttleAddError(t))},e.addTransaction=function(t){this._configService.isActive()&&(this.transactionQueue||this.initTransactionQueue(),this.throttleAddTransaction(t))},e.warnOnce=function(t){"warn"===t.level?(t.level="debug",this._loggingService.warn(t.message)):this._loggingService.debug(t.message)},e.ndjsonErrors=function(t){return t.map(function(t){return a.stringify({error:t})})},e.sendErrors=function(t){if(this._configService.isValid()&&this._configService.isActive()){if(t&&0<t.length){var e={service:this.createServiceObject(),errors:t};if(e=this._configService.applyFilters(e)){var n=this._configService.getEndpointUrl("errors"),r=this.ndjsonErrors(e.errors);r.unshift(a.stringify({metadata:{service:e.service}}));var i=r.join("");return this._postJson(n,i)}this._loggingService.warn("Dropped payload due to filtering!")}}else this.warnOnce(this.logMessages.invalidConfig)},e.ndjsonTransactions=function(t){var n=this.ndjsonSpan;return t.map(function(t){var e="";return t.spans&&(e=t.spans.map(function(t){return n.span=t,a.stringify(n)}).join(""),delete t.spans),a.stringify({transaction:t})+e})},e.sendTransactions=function(t){if(this._configService.isValid()&&this._configService.isActive()){if(t&&0<t.length){var e={service:this.createServiceObject(),transactions:t};if(e=this._configService.applyFilters(e)){var n=this._configService.getEndpointUrl("transactions"),r=this.ndjsonTransactions(e.transactions);r.unshift(a.stringify({metadata:{service:e.service}}));var i=r.join("");return this._postJson(n,i)}this._loggingService.warn("Dropped payload due to filtering!")}}else this.warnOnce(this.logMessages.invalidConfig)},t}();t.exports=s},function(t,e){var n=function(){function t(t,e){e||(e={}),this.onFlush=t,this.items=[],this.queueLimit=e.queueLimit||-1,this.flushInterval=e.flushInterval||0,this.timeoutId=void 0}var e=t.prototype;return e._setTimer=function(){var t=this;this.timeoutId=setTimeout(function(){t.flush()},this.flushInterval)},e.flush=function(){this.onFlush(this.items),this._clear()},e._clear=function(){void 0!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this.items=[]},e.add=function(t){this.items.push(t),-1!==this.queueLimit&&this.items.length>=this.queueLimit?this.flush():void 0===this.timeoutId&&this._setTimer()},t}();t.exports=n},function(t,e){t.exports=function(e,n,t){var r,i=t.context||this,o=t.limit,a=t.interval,s=t.countFn||function(){},c=0;return function(){var t="function"==typeof s&&s.apply(i,arguments);return"number"!=typeof t&&(t=1),c+=t,void 0===r&&(r=setTimeout(function(){r=void(c=0)},a)),o<c?"function"==typeof n?n.apply(i,arguments):void 0:e.apply(i,arguments)}}},function(t,e){var n=function(){function t(){}return t.stringify=function(t){return JSON.stringify(t)+"\n"},t}();t.exports=n},function(t,e,n){var r=n(0),i=r.getCurrentScript,o=r.sanitizeString,a=r.setTag,s=r.merge,c=n(3),u=n(1);var f=function(){function t(){this.config={},this.defaults={serviceName:"",serviceVersion:"",agentName:"js-base",agentVersion:"%%agent-version%%",serverUrl:"http://localhost:8200",serverUrlPrefix:"/intake/v2/rum/events",active:!0,debug:!1,logLevel:"warn",browserResponsivenessInterval:500,browserResponsivenessBuffer:3,checkBrowserResponsiveness:!0,groupSimilarSpans:!0,similarSpanThreshold:.05,capturePageLoad:!0,ignoreTransactions:[],errorThrottleLimit:20,errorThrottleInterval:3e4,transactionThrottleLimit:20,transactionThrottleInterval:3e4,transactionDurationThreshold:6e4,queueLimit:-1,flushInterval:500,sendPageLoadTransaction:!0,serverStringLimit:u.serverStringLimit,distributedTracing:!0,distributedTracingOrigins:[],distributedTracingHeaderValueCallback:void 0,distributedTracingHeaderName:"elastic-apm-traceparent",pageLoadTraceId:void 0,pageLoadSpanId:void 0,pageLoadSampled:void 0,pageLoadTransactionName:void 0,transactionSampleRate:1,context:{},platform:{}},this._changeSubscription=new c,this.filters=[]}var e=t.prototype;return e.init=function(){var t=function(t){if(!t)return{};for(var e={},n=/^data-([\w-]+)$/,r=t.attributes,i=0;i<r.length;i++){var o=r[i];if(n.test(o.nodeName)){var a=o.nodeName.match(n)[1],s=a.split("-").map(function(t,e){return 0<e?t.charAt(0).toUpperCase()+t.substring(1):t}).join("");e[s]=o.value||o.nodeValue}}return e}(i());this.setConfig(t)},e.isActive=function(){return this.get("active")},e.addFilter=function(t){if("function"!=typeof t)throw new Error("Argument to must be function");this.filters.push(t)},e.applyFilters=function(t){for(var e=0;e<this.filters.length;e++)if(!(t=this.filters[e](t)))return;return t},e.get=function(t){return t.split(".").reduce(function(t,e){return t&&t[e]},this.config)},e.getEndpointUrl=function(){return this.get("serverUrl")+this.get("serverUrlPrefix")},e.set=function(t,e){for(var n=t.split("."),r=n.length-1,i=this.config,o=0;o<r+1;o++){var a=n[o];if(a)if(o===r)i[a]=e;else{var s=i[a]||{};i[a]=s,i=s}}},e.setUserContext=function(t){var e={};"number"==typeof t.id&&(e.id=t.id),"string"==typeof t.id&&(e.id=o(t.id,this.get("serverStringLimit"))),"string"==typeof t.username&&(e.username=o(t.username,this.get("serverStringLimit"))),"string"==typeof t.email&&(e.email=o(t.email,this.get("serverStringLimit"))),this.set("context.user",e)},e.setCustomContext=function(t){t&&"object"==typeof t&&this.set("context.custom",t)},e.setTag=function(t,e){t&&(this.config.context.tags||(this.config.context.tags={}),a(t,e,this.config.context.tags))},e.addTags=function(e){var n=this;Object.keys(e).forEach(function(t){n.setTag(t,e[t])})},e.setConfig=function(t){t=t||{},this.config=s({},this.defaults,this.config,t),this._changeSubscription.applyAll(this,[this.config])},e.subscribeToChange=function(t){return this._changeSubscription.subscribe(t)},e.isValid=function(){for(var t=["serviceName","serverUrl"],e=0;e<t.length;e++){var n=t[e];if(null==this.config[n]||""===this.config[n])return!1}return!0},t}();t.exports=f},function(t,e,n){var r=n(0).noop,i=function(){function t(t){t||(t={}),this.levels=["trace","debug","info","warn","error"],this.level=t.level||"info",this.prefix=t.prefix||"",this.resetLogMethods()}var e=t.prototype;return e.shouldLog=function(t){return this.levels.indexOf(t)>=this.levels.indexOf(this.level)},e.setLevel=function(t){this.level=t,this.resetLogMethods()},e.resetLogMethods=function(){var o=this;this.levels.forEach(function(i){o[i]=o.shouldLog(i)?function(){var t,e=o.prefix;switch(i){case"trace":case"debug":t="info";break;default:t=i}var n=arguments;e&&("function"==typeof e&&(e=e(i)),n[0]=e+n[0]);if(console){var r=console[t]?console[t]:console.log;"function"==typeof r&&r.apply(console,n)}}:r})},t}();t.exports=i},function(t,e,n){"use strict";t.exports=n(33).polyfill()},function(t,e,n){t.exports=function(){"use strict";function u(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,e=void 0,i=void 0,s=function(t,e){h[r]=t,h[r+1]=e,2===(r+=2)&&(i?i(l):S())},t="undefined"!=typeof window?window:void 0,o=t||{},a=o.MutationObserver||o.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(l,1)}}var h=new Array(1e3);function l(){for(var t=0;t<r;t+=2){var e=h[t],n=h[t+1];e(n),h[t]=void 0,h[t+1]=void 0}r=0}var p,v,g,m,S=void 0;function y(t,e){var n=this,r=new this.constructor(b);void 0===r[T]&&H(r);var i=n._state;if(i){var o=arguments[i-1];s(function(){return M(i,r,o,n._result)})}else A(n,r,t,e);return r}function _(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(b);return I(e,t),e}S=c?function(){return process.nextTick(l)}:a?(v=0,g=new a(l),m=document.createTextNode(""),g.observe(m,{characterData:!0}),function(){m.data=v=++v%2}):f?((p=new MessageChannel).port1.onmessage=l,function(){return p.port2.postMessage(0)}):void 0===t?function(){try{var t=Function("return this")().require("vertx");return void 0===(e=t.runOnLoop||t.runOnContext)?d():function(){e(l)}}catch(t){return d()}}():d();var T=Math.random().toString(36).substring(2);function b(){}var w=void 0,E=1,C=2,x={error:null};function L(t){try{return t.then}catch(t){return x.error=t,x}}function N(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function O(t,e,n){var r,i,o,a;e.constructor===t.constructor&&n===y&&e.constructor.resolve===_?(o=t,(a=e)._state===E?R(o,a._result):a._state===C?F(o,a._result):A(a,void 0,function(t){return I(o,t)},function(t){return F(o,t)})):n===x?(F(t,x.error),x.error=null):void 0===n?R(t,e):u(n)?(r=e,i=n,s(function(e){var n=!1,t=N(i,r,function(t){n||(n=!0,r!==t?I(e,t):R(e,t))},function(t){n||(n=!0,F(e,t))},e._label);!n&&t&&(n=!0,F(e,t))},t)):R(t,e)}function I(t,e){var n,r;t===e?F(t,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=e),null===n||"object"!==r&&"function"!==r?R(t,e):O(t,e,L(e)))}function k(t){t._onerror&&t._onerror(t._result),P(t)}function R(t,e){t._state===w&&(t._result=e,t._state=E,0!==t._subscribers.length&&s(P,t))}function F(t,e){t._state===w&&(t._state=C,t._result=e,s(k,t))}function A(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+E]=n,i[o+C]=r,0===o&&t._state&&s(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,a=0;a<e.length;a+=3)r=e[a],i=e[a+n],r?M(n,r,i,o):i(o);t._subscribers.length=0}}function M(t,e,n,r){var i=u(n),o=void 0,a=void 0,s=void 0,c=void 0;if(i){if((o=function(t,e){try{return t(e)}catch(t){return x.error=t,x}}(n,r))===x?(c=!0,a=o.error,o.error=null):s=!0,e===o)return void F(e,new TypeError("A promises callback cannot return that same promise."))}else o=r,s=!0;e._state!==w||(i&&s?I(e,o):c?F(e,a):t===E?R(e,o):t===C&&F(e,o))}var j=0;function H(t){t[T]=j++,t._state=void 0,t._result=void 0,t._subscribers=[]}var U=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(b),this.promise[T]||H(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&R(this.promise,this._result))):F(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===w&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===_){var i=L(e);if(i===y&&e._state!==w)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===D){var o=new n(b);O(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===w&&(this._remaining--,t===C?F(r,n):this._result[e]=n),0===this._remaining&&R(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;A(t,void 0,function(t){return n._settledAt(E,e,t)},function(t){return n._settledAt(C,e,t)})},t}(),D=function(){function e(t){this[T]=j++,this._result=this._state=void 0,this._subscribers=[],b!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){I(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return u(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return D.prototype.then=y,D.all=function(t){return new U(this,t).promise},D.race=function(i){var o=this;return n(i)?new o(function(t,e){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(t,e)}):new o(function(t,e){return e(new TypeError("You must pass an array to race."))})},D.resolve=_,D.reject=function(t){var e=new this(b);return F(e,t),e},D._setScheduler=function(t){i=t},D._setAsap=function(t){s=t},D._asap=s,D.polyfill=function(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=D},D.Promise=D}()},function(t,e){var n=function(){function t(t,e){this._disable=e,this.serviceFactory=t,this._initialized=!1}var e=t.prototype;return e.init=function(t){if(this.isEnabled()&&!this._initialized){this._initialized=!0;var e=this.serviceFactory.getService("ConfigService");e.setConfig({agentName:"js-base",agentVersion:"3.0.0"}),e.setConfig(t),this.serviceFactory.init(),this.serviceFactory.getService("ErrorLogging").registerGlobalEventListener(),this.serviceFactory.getService("PerformanceMonitoring").init(),e.get("sendPageLoadTransaction")&&this._sendPageLoadMetrics()}return this},e._sendPageLoadMetrics=function(){var t=this.serviceFactory.getService("TransactionService"),e=this.serviceFactory.getService("ConfigService"),n=t.startTransaction(e.get("pageLoadTransactionName"),"page-load"),r=function(){setTimeout(function(){n&&n.detectFinish()})};"complete"===document.readyState?r():window.addEventListener("load",r)},e.isEnabled=function(){return!this._disable},e.config=function(t){this.serviceFactory.getService("ConfigService").setConfig(t)},e.setUserContext=function(t){this.serviceFactory.getService("ConfigService").setUserContext(t)},e.setCustomContext=function(t){this.serviceFactory.getService("ConfigService").setCustomContext(t)},e.addTags=function(t){this.serviceFactory.getService("ConfigService").addTags(t)},e.setInitialPageLoadName=function(t){this.isEnabled()&&this.serviceFactory.getService("ConfigService").setConfig({pageLoadTransactionName:t})},e.startTransaction=function(t,e){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").startTransaction(t,e)},e.startSpan=function(t,e){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").startSpan(t,e)},e.getCurrentTransaction=function(){if(this.isEnabled())return this.serviceFactory.getService("TransactionService").getCurrentTransaction()},e.getTransactionService=function(){if(this.isEnabled())return this.serviceFactory.getService("TransactionService")},e.captureError=function(t){if(this.isEnabled())return this.serviceFactory.getService("ErrorLogging").logError(t)},e.addFilter=function(t){this.serviceFactory.getService("ConfigService").addFilter(t)},t}();t.exports=n}]);
//# sourceMappingURL=elastic-apm-js-base.umd.min.js.map